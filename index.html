<!DOCTYPE html>
<html lang="zh-TW" data-bs-theme="light">
<head>
  <meta charset="UTF-8" />
  <title>ğŸMapleStory Astarå…¬æœƒå°ˆå±¬ç¶²ç«™ğŸ</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

  <!-- Bootstrap JS (Modal éœ€è¦) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!---->
  <!-- è·æ¥­åˆ†ä½ˆçµ±è¨ˆ Modal -->
<div class="modal fade" id="jobStatsModal" tabindex="-1" aria-labelledby="jobStatsLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
	<div class="modal-content">
	  <div class="modal-header">
		<h5 class="modal-title" id="jobStatsLabel">å…¬æœƒè·æ¥­åˆ†ä½ˆçµ±è¨ˆï¼ˆä¸å«å¤–æ´å¤§å¤§ï¼‰</h5>
		<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	  </div>
	  <div class="modal-body">
		<canvas id="jobStatsCanvas" height="140"></canvas>
		<small class="text-muted d-block mt-2">
		  èªªæ˜ï¼šçµ±è¨ˆä¾†æºç‚ºåˆ—è¡¨è®€å…¥çš„ Google Sheetï¼›åŒç¾©è·æ¥­æœƒè‡ªå‹•åˆä½µï¼ˆå¦‚ã€Œåå­—è»=è‹±é›„ã€ï¼‰ã€‚
		</small>
	  </div>
	  <div class="modal-footer">
		<button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">é—œé–‰</button>
	  </div>
	</div>
  </div>
</div>

  <!---->


  <style>
	body 
	{
        overflow-y: scroll;
        margin: 0;
        padding: 0;
    }
  
    .status-badge { font-size: 0.85rem; }
    .group-row { background: rgba(0,0,0,.03); font-weight: 600; }
    button.secondary { background: transparent; color: var(--text); border: 1px solid var(--border); }
    #sourceBadge { display: none !important; }
	
	<!-- /* åˆ†é å¤–æ¡† + é¡è‰² */ -->
	.nav-tabs-custom .nav-link{
	  border:2px solid transparent;
	  font-weight:600;
	  margin-right:.5rem;
	}
	.nav-tabs-custom .nav-link:hover{
	  opacity:.9;
	}

	<!-- /* æ™®é€šæ‹‰åœ–æ–¯ï¼ˆè—ï¼‰ */ -->
	.nav-tabs-custom .tab-latus{
	  color:#0d6efd;
	  border-color:#0d6efd;
	}
	.nav-tabs-custom .tab-latus.active{
	  color:#fff;
	  background:#0d6efd;
	}
	
	<!-- /* å›°è—æ‹‰åœ–æ–¯ï¼ˆç´«ï¼‰ */ -->
	.nav-tabs-custom .tab-latushard{
	  color:#6f42c1;
	  border-color:#6f42c1;
	}
	.nav-tabs-custom .tab-latushard.active{
	  color:#fff;
	  background:#6f42c1;
	}	

	<!-- /* æ®˜æš´ç‚é­”ï¼ˆæ©˜ï¼‰ */ -->
	.nav-tabs-custom .tab-zakum{
	  color:#fd7e14;
	  border-color:#fd7e14;
	}
	.nav-tabs-custom .tab-zakum.active{
	  color:#fff;
	  background:#fd7e14;
	}

	<!-- /* è¨“ç·´ç‡Ÿ&å¤–æ´ï¼ˆç¶ ï¼‰ */ -->
	.nav-tabs-custom .tab-misc{
	  color:#198754;
	  border-color:#198754;
	}
	.nav-tabs-custom .tab-misc.active{
	  color:#fff;
	  background:#198754;
	}
	
	.tab_css{display:flex;flex-wrap:wrap;justify-content:flex-start;}
	.tab_css input{display:none}
	.tab_css label{margin: 0 5px 5px 0; padding: 10px 16px; cursor: pointer; border-radius: 5px; background: #0d6efd; color: #fff; opacity: 0.638;}
	.tab_content{order:1; display: none; width:100%; border-bottom: 3px solid #ddd; line-height: 1.6; font-size: 0.85rem; padding: 15px; border: 1px solid #ddd; border-radius: 5px;}
	.tab_css input:checked + label, .tab_css label:hover{opacity: 1; font-weight:bold;}
	.tab_css input:checked + label + .tab_content{display: initial;}
	
	.title{font-weight:bold; font-size:1.0rem;}
	
	<!-- /* é‡å°æ¨™ç±¤å…§çš„å…§å®¹é€²è¡Œé‡è£½ */ -->
	.reset-content 
	{
		<!-- /* all: revert; */ -->   
		display: table-cell;  
		line-height: 1.5; 
		font-size: 1rem;    
		padding: 0.5;           
		border: none;         
	}

	<!-- /* å¦‚æœæ˜¯é‡å°æ•´å€‹è¡¨æ ¼ï¼Œå¯ä»¥æ›´ç°¡å–® */ -->
	.clean-table 
	{
		all: revert;
		width: 100%;
		border-collapse: collapse;
	}

  </style>
</head>
<body class="bg-body">
  <nav class="navbar navbar-expand-lg bg-primary navbar-dark">
    <div class="container-fluid">
      <span class="navbar-brand btn-sm title" style="font-size:1.25rem;">ğŸMapleStory Astarå…¬æœƒå°ˆå±¬ç¶²ç«™ğŸ-1423</span>
      <div class="ms-auto d-flex align-items-center gap-2">
        <span id="sourceBadge" class="badge bg-light text-dark status-badge">sheetId=1-j04395CPwDlZnJ2vUt3k4wsT5rPHgQWmujSQCi76Fs | gid=0</span>
		<!-- å°å¤¥ä¼´æ¸…å–® -->
		<button id="backToList" class="btn btn-outline-light btn-sm title">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å…¬æœƒå°å¤¥ä¼´</button>
        <button id="Guide" class="btn btn-outline-light btn-sm title">ğŸš€ éŠæˆ²æ”»ç•¥</button>
		<!-- å…¨è·æ¥­æ”»ç•¥æŒ‰éˆ•ï¼ˆæ­¦å™¨åœ–æ¡ˆï¼‰ -->
		<!-- <a href="https://docs.google.com/spreadsheets/d/1lPS_dyOfFe04SbmavvqAZT6GVTOuN-F-qSXDhQlpfUY/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm" title="å…¨è·æ¥­æ”»ç•¥">âš”ï¸ å…¨è·æ¥­æ”»ç•¥</a> -->
		<!-- å…¨è·æ¥­å››è½‰æŠ€èƒ½ä»»å‹™æŒ‰éˆ•ï¼ˆä»»å‹™åœ–æ¡ˆï¼‰ -->
		<!-- <a href="https://docs.google.com/document/u/0/d/1fripMi-WrPOh9ZpdAfUlyiUZd42Btt_tIpNohXLLE3A/mobilebasic" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm" title="å…¨è·æ¥­æ”»ç•¥">ğŸ§¾ å…¨è·æ¥­æŠ€èƒ½ä»»å‹™</a> -->
        <!-- ç¬¬ä¸‰æ–¹äº¤æ˜“å¹³å°æŒ‰éˆ• -->
        <a href="https://artale-market.org/" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm title" title="ç¬¬ä¸‰æ–¹äº¤æ˜“å¹³å°">ğŸª ç¬¬ä¸‰æ–¹äº¤æ˜“å¹³å°</a>
        <!-- æ€ªç‰©æ‰è½ç‰©æŸ¥è©¢å·¥å…·æŒ‰éˆ•ï¼ˆæ€ªç‰©åœ–æ¡ˆï¼‰ -->
        <a href="https://a2983456456.github.io/artale-drop/" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm title" title="æ€ªç‰©æ‰è½ç‰©æŸ¥è©¢å·¥å…·">ğŸ‘¾ æ€ªç‰©æ‰è½ç‰©æŸ¥è©¢å·¥å…·</a>
        <!-- å¥³ç¥ 400 é€Ÿè§£å°å·¥å…·æŒ‰éˆ• -->
        <!--  <a href="https://rvgin.github.io/tower-of-goddess/" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm" title="å¥³ç¥ 400 é€Ÿè§£å°å·¥å…·">ğŸ‘¸ å¥³ç¥ 400 é€Ÿè§£å°å·¥å…·</a> -->
        <!-- è£œå“ç”Ÿå­˜æ¨¡æ“¬å™¨æŒ‰éˆ• -->
        <!-- <a href="https://philipc-1.github.io/MapleStory/HPsimulator.html" target="_blank" rel="noopener noreferrer" class="btn btn-outline-light btn-sm" title="è£œå“ç”Ÿå­˜æ¨¡æ“¬å™¨">ğŸ’Š è£œå“ç”Ÿå­˜æ¨¡æ“¬å™¨</a> -->
		<!-- æ”¾åœ¨ id="Zakum" æŒ‰éˆ•ã€Œå‰é¢ã€ -->
		<!-- <button id="LatusGuide" class="btn btn-outline-light btn-sm">â° æ‹‰åœ–æ–¯æ”»ç•¥</button> -->
        <!-- <button id="Zakum" class="btn btn-outline-light btn-sm">ğŸ—¿ æ®˜æš´ç‚é­”æ”»ç•¥</button> -->
        <button id="toggleTheme" class="btn btn-outline-light btn-sm title"">ğŸŒ™ å¤œé–“æ¨¡å¼</button>
      </div>
    </div>
  </nav>

  <!-- å…¬æœƒå°å¤¥ä¼´ -->
	<div id="homePage" class="container py-4">
		<div class="d-flex align-items-center justify-content-between mb-2">
			<h3 class="mb-0"><b>ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å…¬æœƒå°å¤¥ä¼´</b></h3>
		</div>
		
    <!-- æç¤ºå¡ç‰‡ -->
    <div class="card shadow-sm mb-4">
      <div class="card-body">
		<div class="d-flex justify-content-between align-items-center mb-0" style="padding-left:32px;">
			<h4 class="card-title mb-2">â¡ï¸ è³‡æ–™ä¾†æº</h4>
		</div>
        <p class="mb-0 text-muted">è«‹å„ä½æª¢è¦–ä¸€ä¸‹è‡ªå·±çš„è³‡æ–™æ˜¯å¦é ˆæ›´æ–°ï¼Œè‹¥è¦æ›´æ–°è«‹é»æ“Šã€ä¿®æ”¹ã€‘æŒ‰éˆ•é€²è¡Œæ›´æ–°ã€‚è‹¥é‡ç„¡æ³•æ›´æ–°æƒ…å½¢è«‹é€²ä»¥ä¸‹ç¶²å€é€²å…¥Excelè¡¨æ‰¾åˆ°è‡ªå·±çš„æ¬„ä½æ›´æ–°è³‡æ–™ ã€€ï½æ„Ÿæ©çš„å¿ƒï½</p>
        <small class="text-muted">
          <a href="https://docs.google.com/spreadsheets/d/1-j04395CPwDlZnJ2vUt3k4wsT5rPHgQWmujSQCi76Fs/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer">
            https://docs.google.com/spreadsheets/d/1-j04395CPwDlZnJ2vUt3k4wsT5rPHgQWmujSQCi76Fs/edit?gid=0#gid=0
          </a>
        </small>
        <div id="msg" class="text-danger mt-2"></div>
      </div>
    </div>

    <div class="card shadow-sm">
		<div class="card-body">
			<div class="d-flex justify-content-between align-items-center mb-2" style="padding-left:32px;">
				<h4 class="card-title mb-2">ğŸ‹ï¸ è§’è‰²æ¸…å–®</h4>
				<div class="d-flex align-items-center gap-2">
					<button id="addBtn" class="btn btn-primary btn-sm">æ–°å¢è§’è‰²</button>
					<button id="btnJobStats" class="btn btn-outline-primary btn-sm">ğŸ“Š å…¬æœƒè·æ¥­åˆ†ä½ˆçµ±è¨ˆ</button>
					<button id="reloadBtn" class="btn btn-outline-secondary btn-sm">é‡æ–°æ•´ç†</button>
				</div>
			</div>

        <!-- â˜… æ–°å¢ï¼šåˆ†é åˆ‡æ›ï¼ˆåƒ…åˆ‡æ›é¡¯ç¤ºç‡Ÿå€ï¼‰ -->
        <ul class="nav nav-pills nav-tabs-custom mb-3" id="campTabs" role="tablist">
			<li class="nav-item" role="presentation">
				<button id="tabLatus" class="nav-link tab-latus active" type="button" role="tab">æ‹‰åœ–æ–¯(æ™®é€š)</button>
			</li>
			<!-- æ”¾åœ¨ id="tabLatus" ä¹‹å¾Œã€id="tabZakumList" ä¹‹å‰ -->
			<li class="nav-item" role="presentation">
				<button id="tabLatusHard" class="nav-link tab-latushard" type="button" role="tab">æ‹‰åœ–æ–¯(å›°é›£)</button>
			</li>
			<li class="nav-item" role="presentation">
				<button id="tabZakumList" class="nav-link tab-zakum" type="button" role="tab">æ®˜æš´ç‚é­”</button>
			</li>
			<li class="nav-item" role="presentation">
				<button id="tabTrainExt" class="nav-link tab-misc" type="button" role="tab">è¨“ç·´ç‡Ÿ&å¤–æ´å°ˆå€</button>
			</li>
		</ul>


        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle reset-content">
            <thead class="table-secondary">
              <tr>
                <th style="width: 20%;">è§’è‰²åç¨±</th>
                <th style="width: 10%;">è§’è‰²ä»£ç¢¼</th>
                <th style="width: 20%;">è§’è‰²è·æ¥­</th>
                <th style="width: 10%;">è§’è‰²ç­‰ç´š</th>
                <th style="width: 10%;">è§’è‰²ä¹¾è¡¨</th>
                <th style="width: 20%;">æ‰€åœ¨ç‡Ÿå€</th>
                <th style="width: 10%;">ä¿®æ”¹è³‡æ–™</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <tr>
                <td colspan="7" class="text-center text-muted">å°šæœªè®€å–è³‡æ–™</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

<!-- å”å”ç‰ˆä¸€åœ–æµæ”»ç•¥ Modal -->
	<div class="modal fade" id="uncleGuideModal" tabindex="-1" aria-labelledby="uncleGuideLabel" aria-hidden="true">
	  <div class="modal-dialog modal-xl modal-dialog-scrollable">
		<div class="modal-content">
		  <div class="modal-header">
			<h5 class="modal-title" id="uncleGuideLabel">å”å”ç‰ˆä¸€åœ–æµæ”»ç•¥</h5>
			<a id="uncleGuideOpenNew" class="btn btn-link btn-sm" target="_blank" rel="noopener noreferrer">åœ¨æ–°é é¢é–‹å•Ÿ</a>
			<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é—œé–‰"></button>
		  </div>
		  <div class="modal-body">
			<div class="ratio ratio-16x9">
			  <iframe id="uncleGuideFrame" src="" title="Uncle Guide" style="border:0;"></iframe>
			</div>
			<small class="text-muted d-block mt-2">è‹¥æœªé¡¯ç¤ºï¼Œè«‹ç¢ºèªé›²ç«¯è³‡æ–™å¤¾æ¬Šé™ç‚ºã€ŒçŸ¥é“é€£çµçš„ä»»ä½•äººå¯æª¢è¦–ã€ã€‚</small>
		  </div>
		  <div class="modal-footer">
			<button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">é—œé–‰</button>
		  </div>
		</div>
	  </div>
	</div>

	<!-- Zakum æ®˜æš´ç‚é­”æ”»ç•¥ï¼ˆé è¨­éš±è—ï¼‰ -->
	<div id="zakumPage" class="container py-4 d-none">
	<div class="d-flex align-items-center justify-content-between mb-3">
	  <h5 class="mb-0">ğŸ—¿ æ®˜æš´ç‚é­”æ”»ç•¥ï¼ˆZakum Guideï¼‰</h5>
		  <div class="d-flex align-items-center gap-2">
			<button id="backToList" class="btn btn-outline-secondary btn-sm">â† è¿”å›è§’è‰²æ¸…å–®</button>
			<button id="btnUncleGuide" class="btn btn-outline-primary btn-sm">ğŸ“œ å”å”ç‰ˆä¸€åœ–æµæ”»ç•¥</button>
		  </div>
	</div>

	<div class="card shadow-sm mb-3">
	  <div class="card-body">
		<h5 class="card-title mb-2">å®˜æ–¹æ”»ç•¥æ–‡ä»¶ï¼ˆå…§åµŒï¼‰</h5>
		<!-- Bootstrap éŸ¿æ‡‰å¼æ¯”ä¾‹ç›’ï¼Œè®“ iframe è‡ªé©æ‡‰å¤§å° -->
		<div class="ratio ratio-16x9">
		  <iframe id="zakumDocFrame" src="" title="Zakum Guide Doc" allowfullscreen style="border:0;"></iframe>
		</div>
		<small class="text-muted d-block mt-2">
		  è‹¥æœªé¡¯ç¤ºï¼Œè«‹ç¢ºèª Google æ–‡ä»¶å·²ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€æˆ–æ¬Šé™è¨­å®šå…è¨±å…§åµŒã€‚
		</small>
	  </div>
	</div>
	</div>

	<!-- æ”¾åœ¨ #zakumPage å€å¡Šå¾Œé¢ï¼ˆåŒå±¤ç´šï¼‰ -->
	<div id="latusPage" class="container py-4 d-none">
	  <div class="d-flex align-items-center justify-content-between mb-3">
		<h3 class="mb-0">ğŸ‰ æ‹‰åœ–æ–¯æ”»ç•¥ï¼ˆLatus Guideï¼‰</h3>
		<div class="d-flex align-items-center gap-2">
		  <button id="backToList" class="btn btn-outline-secondary btn-sm">â† è¿”å›è§’è‰²æ¸…å–®</button>
		  <button id="btnLatusNormal" class="btn btn-outline-primary btn-sm">ğŸ“˜ æ™®é€šæ‹‰åœ–æ–¯æ”»ç•¥</button>
		  <button id="btnLatusHard" class="btn btn-outline-primary btn-sm">ğŸ“™ å›°é›£æ‹‰åœ–æ–¯æ”»ç•¥</button>
		</div>
	  </div>

	  <div class="card shadow-sm mb-3">
		<div class="card-body">
		  <h5 class="card-title mb-2">æ”»ç•¥æ–‡ä»¶ï¼ˆå…§åµŒï¼‰</h5>
		  <div class="ratio ratio-16x9">
			<iframe id="latusDocFrame" src="" title="Latus Guide Doc" allowfullscreen style="border:0;"></iframe>
		  </div>
		  <small class="text-muted d-block mt-2">
			è‹¥æœªé¡¯ç¤ºï¼Œè«‹ç¢ºèª Google æ–‡ä»¶å·²ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€æˆ–æ¬Šé™è¨­å®šå…è¨±å…§åµŒã€‚
		  </small>
		</div>
	  </div>
	</div>

	<!-- æ”¾åœ¨ #zakumPage å€å¡Šå¾Œé¢ï¼ˆåŒå±¤ç´šï¼‰ -->
	<div id="GuidePage" class="container py-4 d-none">
		<div class="d-flex align-items-center justify-content-between mb-3">
			<h3 class="mb-0"><b>ğŸš€ éŠæˆ²æ”»ç•¥ï¼ˆGame Guideï¼‰<b></h3>
			<div class="d-flex align-items-center gap-2">
				<button id="backToList" class="btn btn-outline-secondary btn-sm">â† è¿”å›è§’è‰²æ¸…å–®</button>
				<!-- <button id="btnUncleGuide" class="btn btn-outline-primary btn-sm">ğŸ“œ å”å”ç‰ˆä¸€åœ–æµæ”»ç•¥</button> -->
			</div>
		</div>

		<div class="card shadow-sm">
			<div class="card-body">
		<!--
			<div class="d-flex justify-content-between align-items-center mb-3">
			<h5 class="card-title mb-0">è§’è‰²æ¸…å–®</h5>
			<div class="d-flex align-items-center gap-2">
				<button id="addBtn" class="btn btn-primary btn-sm">æ–°å¢è§’è‰²</button>
				<button id="btnJobStats" class="btn btn-outline-primary btn-sm">ğŸ“Š å…¬æœƒè·æ¥­åˆ†ä½ˆçµ±è¨ˆ</button>
				<button id="reloadBtn" class="btn btn-outline-secondary btn-sm">é‡æ–°æ•´ç†</button>
			</div>
			</div>
			-->
			
			<!-- <div class="tab_css nav-link"> -->
			<div class="tab_css nav-link">
			<!-- TAB1 æ‰“åŒ…å€å¡Š start -->
			<input id="tab1" type="radio" name="tab" checked="checked"/>
			<label for="tab1" style="background-color:#fd7e14;">å”å”ä¸€åœ–æµ</label>
			
			
			<div class="tab_content card border-0">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center mb-2">
						<h4 class="card-title mb-2">ğŸŒŸ å”å”ä¸€åœ–æµ</h4>
						<div class="d-flex align-items-center gap-2">
							<button id="reloadBtn_OneP" class="btn btn-outline-secondary btn-sm">é‡æ–°æ•´ç†</button>
						</div>
					</div>
				</div>
				
				<div class="table-responsive">
					<table class="table table-striped table-hover align-middle reset-content">
						<thead class="table-secondary">
						<tr>
							<th style="width: 20%;">åˆ†é¡</th>
							<th style="width: 20%;">åç¨±</th>
							<th style="width: 20%;">é—œéµå­—</th>
							<th style="width: 40%;">åœ–ç‰‡</th>
						</tr>
						</thead>
						<tbody id="tableBody_OneP">
						<tr>
							<td colspan="4" class="text-center text-muted">å°šæœªè®€å–è³‡æ–™</td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
			<!-- TAB1 æ‰“åŒ…å€å¡Š end -->
	
			<!-- TAB2 æ‰“åŒ…å€å¡Š start -->
			<input id="tab2" type="button" name="tab"/>
			<label for="tab2" ><a href="https://docs.google.com/spreadsheets/d/1lPS_dyOfFe04SbmavvqAZT6GVTOuN-F-qSXDhQlpfUY/edit?gid=0#gid=0" style="color:#FFF;text-decoration:none;" target="_blank" rel="noopener noreferrer">å…¨è·æ¥­æ”»ç•¥</a></label>
			<div class="tab_content card border-0">
				ç¬¬ 2 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
				ç¬¬ 2 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
			</div>
			<!-- TAB2 æ‰“åŒ…å€å¡Š end -->
	
			<!-- TAB3 æ‰“åŒ…å€å¡Š start -->
			<input id="tab3" type="button" name="tab"/>
			<label for="tab3"><a href="https://docs.google.com/document/u/0/d/1fripMi-WrPOh9ZpdAfUlyiUZd42Btt_tIpNohXLLE3A/mobilebasic" style="color:#FFF;text-decoration:none;" target="_blank" rel="noopener noreferrer">å…¨è·æ¥­å››è½‰æŠ€èƒ½</a></label>
			<div class="tab_content card border-0">
				ç¬¬ 3 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
				ç¬¬ 3 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
			</div>
			<!-- TAB3 æ‰“åŒ…å€å¡Š end -->
			
	
			<!-- TAB4 å›°é›£æ‹‰åœ–æ–¯ start -->
			<input id="tab4" type="radio" name="tab"/>
			<label for="tab4" style="background-color:#6f42c1;">å›°é›£æ‹‰åœ–æ–¯</label>
			<div class="tab_content card border-0">
				<div class="card-body">
					<h4 class="card-title mb-2">â° å›°é›£æ‹‰åœ–æ–¯æ”»ç•¥ï¼ˆHard Papulatus Guideï¼‰</h4>
					<!-- Bootstrap éŸ¿æ‡‰å¼æ¯”ä¾‹ç›’ï¼Œè®“ iframe è‡ªé©æ‡‰å¤§å° -->
					<div class="ratio ratio-16x9">
					<iframe id="zakumDocFrame" src="https://docs.google.com/document/d/1UrV2RrEJwLZJ8X5t88GXRuxKbbxp9vq6W2Qeu1nqzV0/preview" title="Zakum Guide Doc" allowfullscreen style="border:0;"></iframe>
					</div>
					<small class="text-muted d-block mt-2">
					è‹¥æœªé¡¯ç¤ºï¼Œè«‹ç¢ºèª Google æ–‡ä»¶å·²ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€æˆ–æ¬Šé™è¨­å®šå…è¨±å…§åµŒã€‚
					</small>
				</div>
			</div>
			<!-- TAB4 å›°é›£æ‹‰åœ–æ–¯ end -->
	
			<!-- TAB5 æ®˜æš´ç‚é­” start -->
			<input id="tab5" type="radio" name="tab"/>
			<label for="tab5" style="background-color:#6f42c1;">æ®˜æš´ç‚é­”</label>
			<div class="tab_content card border-0">
				<div class="card-body">
					<h4 class="card-title mb-2">ğŸ—¿ æ®˜æš´ç‚é­”æ”»ç•¥ï¼ˆZakum Guideï¼‰</h4>
					<!-- Bootstrap éŸ¿æ‡‰å¼æ¯”ä¾‹ç›’ï¼Œè®“ iframe è‡ªé©æ‡‰å¤§å° -->
					<div class="ratio ratio-16x9">
					<iframe id="zakumDocFrame" src="https://docs.google.com/document/d/19iRUhl0Es049i5dgVkJlBAuDK3icESjuEqmAGj44cHs/preview" title="Zakum Guide Doc" allowfullscreen style="border:0;"></iframe>
					</div>
					<small class="text-muted d-block mt-2">
					è‹¥æœªé¡¯ç¤ºï¼Œè«‹ç¢ºèª Google æ–‡ä»¶å·²ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€æˆ–æ¬Šé™è¨­å®šå…è¨±å…§åµŒã€‚
					</small>
				</div>
			</div>
			<!-- TAB5 æ®˜æš´ç‚é­” end -->
	
			<!-- TAB6 æ‰“åŒ…å€å¡Š start 198754 -->
			<input id="tab6" type="button" name="tab"/>
			<label for="tab6" style="background-color:#198754;"><a href="https://rvgin.github.io/tower-of-goddess/" style="color:#FFF;text-decoration:none;" target="_blank" rel="noopener noreferrer">å¥³ç¥400å°å·¥å…·</a></label>
			<div class="tab_content card border-0">
				ç¬¬ 6 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
				ç¬¬ 6 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
			</div>
			<!-- TAB6 æ‰“åŒ…å€å¡Š end -->
	
			<!-- TAB6 æ‰“åŒ…å€å¡Š start -->
			<input id="tab7" type="button" name="tab"/>
			<label for="tab7" style="background-color:#198754;"><a href="https://philipc-1.github.io/MapleStory/HPsimulator.html" style="color:#FFF;text-decoration:none;" target="_blank" rel="noopener noreferrer">è£œå“ç”Ÿå­˜æ¨¡æ“¬å™¨</a></label>
			<div class="tab_content card border-0 shadow-sm mb-3">
				ç¬¬ 7 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
				ç¬¬ 7 å€‹é ç±¤å…§å®¹å€å¡Š<br/>
			</div>
			<!-- TAB7 æ‰“åŒ…å€å¡Š end -->
			
			</div>
	
		
			</div>
		
		</div>
		
	</div>

<script>
// æ®˜æš´ç‚é­”æ”»ç•¥ï¼šGoogle æ–‡ä»¶åµŒå…¥ç¶²å€ï¼ˆå»ºè­°ç”¨ç™¼ä½ˆåˆ°ç¶²è·¯å¾Œçš„ /pub?embedded=trueï¼‰
//const ZAKUM_DOC_EMBED = "https://docs.google.com/document/d/19iRUhl0Es049i5dgVkJlBAuDK3icESjuEqmAGj44cHs/pub?embedded=true";
// è‹¥æœªç™¼ä½ˆã€ä½†åˆ†äº«æ¬Šé™é–‹æ”¾ï¼Œä¹Ÿå¯æš«ç”¨ previewï¼ˆå¯èƒ½æœƒè¢« X-Frame-Options æ“‹ï¼‰
 const ZAKUM_DOC_EMBED = "https://docs.google.com/document/d/19iRUhl0Es049i5dgVkJlBAuDK3icESjuEqmAGj44cHs/preview";

/* =========================
   è¨­å®šï¼šè«‹å¡«ä½ çš„ Apps Script Web Appï¼ˆexecï¼‰URL
========================= */
const GAS_UPDATE_URL = 'https://script.google.com/macros/s/AKfycbwbEW15caNLWOUqm8VKby2tN_JfCySTT6xFtreuFz9K0Ex51qioyeqNi476jVH4vlGo/exec';

/* =========================
   å¤œé–“æ¨¡å¼åˆ‡æ›
========================= */
$('#toggleTheme').on('click', function () 
{
  const html = document.documentElement;
  const isDark = html.getAttribute('data-bs-theme') === 'dark';
  html.setAttribute('data-bs-theme', isDark ? 'light' : 'dark');
  $(this).text(isDark ? 'ğŸŒ™ å¤œé–“æ¨¡å¼' : 'â˜€ï¸ æ—¥é–“æ¨¡å¼');
});


/* ==== è¿”å›è§’è‰²æ¸…å–®ï¼šæ“´å……æ—¢æœ‰è™•ç†ï¼Œè®“å…©å€‹æ”»ç•¥é éƒ½èƒ½è¿”å› ==== */
// å°‡ä½ åŸæœ¬çš„ backToList äº‹ä»¶ã€Œæ›¿æ›ã€æˆä¸‹é¢é€™æ®µï¼ˆæˆ–ç›´æ¥è¦†å¯«ï¼‰
$(document).off('click', '#backToList').on('click', '#backToList', function () 
{
  $('#zakumPage').addClass('d-none');
  $('#latusPage').addClass('d-none');
  $('#GuidePage').addClass('d-none');   // éš±è—æ¸…å–®
  $('#homePage').removeClass('d-none');
});

$('#Guide').on('click', function () 
{
  $('#homePage').addClass('d-none');   // éš±è—æ¸…å–®
  $('#latusPage').addClass('d-none');   // éš±è—æ¸…å–®
  $('#zakumPage').addClass('d-none');   // éš±è—æ¸…å–®
  $('#latusPage').addClass('d-none');   // éš±è—æ¸…å–®
  $('#GuidePage').removeClass('d-none'); // é¡¯ç¤ºæ”»ç•¥
});

/* =========================
   æ®˜æš´ç‚é­”æ”»ç•¥ï¼šå–®é åˆ‡æ›
========================= */
//$('#Zakum').on('click', function () 
//{
//  $('#homePage').addClass('d-none');   // éš±è—æ¸…å–®
//  $('#zakumPage').removeClass('d-none'); // é¡¯ç¤ºæ”»ç•¥
//});
//$(document).on('click', '#backToList', function () 
//{
//  $('#zakumPage').addClass('d-none');
//  $('#homePage').removeClass('d-none');
//});
//// åªåœ¨ç¬¬ä¸€æ¬¡æˆ–æ¯æ¬¡åˆ‡æ›æ™‚è¨­å®š/é‡è¨­ srcï¼ˆé¿å…é‡è¤‡è¼‰å…¥ä¹Ÿå¯ä»¥åŠ åˆ¤æ–·ï¼‰
//const $frame = $('#zakumDocFrame');
//if ($frame.attr('src') !== ZAKUM_DOC_EMBED) 
//{
//  $frame.attr('src', ZAKUM_DOC_EMBED);
//}
  

/* =========================
   å…¬ç”¨ï¼šè§£æ URL åƒæ•¸
========================= */
function getQueryParams() {
  const params = new URLSearchParams(window.location.search);
  return Object.fromEntries(params.entries());
}
function parseSheetFromUrl(url) {
  if (!url) return null;
  const idMatch = url.match(/\/d\/([a-zA-Z0-9-_]+)/);
  if (!idMatch) return null;
  const sheetId = idMatch[1];
  const urlObj = new URL(url);
  const gid = urlObj.searchParams.get('gid') || (url.includes('#gid=') ? url.split('#gid=')[1] : '0');
  return { sheetId, gid };
}

/* =========================
   å…¨åŸŸç‹€æ…‹ï¼ˆâ˜… æ–°å¢ï¼‰
========================= */
let currentTab = 'latus';   // 'latus' | 'latushard' | 'zakum' | 'trainext'
let lastData   = [];        // è®€å–å¾Œä¿å­˜ï¼Œåˆ‡åˆ†é æ™‚é‡ç¹ªä½¿ç”¨

/* =========================
   è®€å– Google Sheetï¼ˆä»¥ CSV åŒ¯å‡ºï¼‰
========================= */
function loadFromSheet(sheetId, gid = '0') {
  $('#msg').text('');
  $('#tableBody').html(`
    <tr>
      <td colspan="7" class="text-center text-muted">è®€å–ä¸­...</td>
    </tr>
  `);

  const csvUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=csv&gid=${gid}`;

  Papa.parse(csvUrl, {
    download: true,
    skipEmptyLines: true,
    complete: function (result) {
      try {
        if (!result.data || result.data.length < 2) {
          $('#msg').text('æ²’æœ‰è³‡æ–™å¯é¡¯ç¤º');
          lastData = [];
          renderTable(lastData);
          return;
        }

        const rows = result.data.slice(1);
        lastData = rows
          .map((r, i) => ({
            name:  r[1], // B
            code:  r[2], // Cï¼ˆä¸»éµï¼‰
            job:   r[3], // D
            level: r[4], // E
            attack:r[6], // F ä¹¾è¡¨
            camp:  r[9], // G ç‡Ÿå€
            rowIndex: i + 2
          }))
          .filter(r => r && r.name);

        renderTable(lastData);
      } catch (e) {
        console.error(e);
        $('#msg').text('è§£æè³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤');
        lastData = [];
        renderTable(lastData);
      }
    },
    error: function (err) {
      console.error(err);
      $('#msg').text('è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªè©² Google Sheet å·²è¨­ç‚ºã€ŒçŸ¥é“é€£çµçš„ä»»ä½•äººå¯æª¢è¦–ã€ã€‚');
      lastData = [];
      renderTable(lastData);
    }
  });
}

/* =========================
   ä¾åˆ†é éæ¿¾ + åˆ†çµ„é¡¯ç¤ºï¼ˆâ˜… èª¿æ•´ï¼‰
========================= */
function renderTable(data) {
  // ä¾ç›®å‰åˆ†é éæ¿¾ç‡Ÿå€
  const zhNums = 'ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å';
  const reLatus = new RegExp(`^æ™®æ‹‰[${zhNums}]ç‡Ÿ$`);
  const reLatushard = new RegExp(`^å›°æ‹‰[${zhNums}]ç‡Ÿ$`);
  const reZakum = new RegExp(`^ç‚é­”[${zhNums}]ç‡Ÿ$`);

  const groupNotes = {
    'æ™®æ‹‰ä¸€ç‡Ÿ': 'ğŸ”°æ­çš‡æŒ‡å®šå¸­ğŸ—ï¸',
    'æ™®æ‹‰äºŒç‡Ÿ': 'ğŸ”°ç‘æ°£åƒæ¢åœ˜ğŸ’',
    'æ™®æ‹‰ä¸‰ç‡Ÿ': 'ğŸ”°é¦¬åˆ°æˆåŠŸåœ˜ğŸ',
    'æ™®æ‹‰å››ç‡Ÿ': 'ğŸ”°å‚³å¥‡ç©ºæ®¼åœ˜ğŸ¥¥',
	'æ‹‰åœ–äº”ç‡Ÿ': 'ğŸ”°ç¥–å®—BOBIåœ˜ğŸ›ï¸',
	'æ‹‰åœ–å…­ç‡Ÿ': 'ğŸ”°å‘½å®šä¹‹å…­ï¼šè¬è±¡ç¥å¼•ä¹‹çµ•ä¸–æ‰å¯¶ğŸ²',
    'æ™®æ‹‰ä¸ƒç‡Ÿ': 'ğŸ”°éæ´²ç•¢æ¥­ç­ğŸ—¿',
  };

  const filtered = (data || []).filter(r => {
    const camp = (r.camp || '').trim();
    if (currentTab === 'latus')   return reLatus.test(camp);
	if (currentTab === 'latushard')  return reLatushard.test(camp);
    if (currentTab === 'zakum')   return reZakum.test(camp);
    if (currentTab === 'trainext')return (camp === 'è¨“ç·´ç‡Ÿ' || camp === 'å¤–æ´å¤§å¤§');
    return true;
  });

  // ...ï¼ˆä½ åŸæœ¬ renderTable å¾ŒçºŒçš„åˆ†çµ„/æ’åº/è¼¸å‡ºä¿æŒä¸è®Šï¼‰


  if (!filtered.length) {
    $('#tableBody').html(`
      <tr>
        <td colspan="7" class="text-center text-muted">æ­¤åˆ†é ä¸‹æ²’æœ‰ç¬¦åˆçš„è³‡æ–™</td>
      </tr>
    `);
    return;
  }

  // ä¾ç‡Ÿå€åˆ†çµ„
  const groups = {};
  for (const r of filtered) {
    const key = (r.camp || 'æœªå¡«å¯«').toString().trim();
    if (!groups[key]) groups[key] = [];
    groups[key].push(r);
  }

  // ä¾ã€Œä¸€äºŒä¸‰â€¦åã€æ’åº
  const mapCN = { 'é›¶':0,'ã€‡':0,'ä¸€':1,'äºŒ':2,'å…©':2,'ä¸‰':3,'å››':4,'äº”':5,'å…­':6,'ä¸ƒ':7,'å…«':8,'ä¹':9,'å':10 };
  function chineseNumToInt(txt) {
    if (!txt) return NaN;
    const m = txt.match(/[é›¶ã€‡ä¸€äºŒå…©ä¸‰å››äº”å…­ä¸ƒå…«ä¹å]/g);
    if (!m) return NaN;
    const s = m.join('');
    if (s === 'å') return 10;
    const tenIdx = s.indexOf('å');
    if (tenIdx === -1) return mapCN[s] ?? NaN;
    const left = tenIdx === 0 ? 1 : (mapCN[s[0]] ?? 0);
    const right = tenIdx === s.length - 1 ? 0 : (mapCN[s[tenIdx+1]] ?? 0);
    return left * 10 + right;
  }

  const orderedKeys = Object.keys(groups).sort((a,b) => {
    const na = chineseNumToInt(a);
    const nb = chineseNumToInt(b);
    if (!isNaN(na) && !isNaN(nb)) return na - nb;
    return a.localeCompare(b, 'zh-Hant');
  });

  let html = '';
  for (const k of orderedKeys) {
    const note = groupNotes[k] ? `ã€€${groupNotes[k]}` : ''; // æœ‰å°ç…§å°±åŠ ï¼Œæ²’æœ‰å°±ç©ºå­—ä¸²
    html += `
      <tr class="group-row">
        <td colspan="7">æ‰€åœ¨ç‡Ÿå€ï¼š${k}${note}ï¼ˆ${groups[k].length}ï¼‰</td>
      </tr>`;
    html += groups[k].map(r => `
      <tr>
        <td>${r.name ?? ''}</td>
        <td>${r.code ?? ''}</td>
        <td>${r.job ?? ''}</td>
        <td>${r.level ?? ''}</td>
        <td>${r.attack ?? ''}</td>
        <td>${r.camp ?? ''}</td>
        <td>
          <button class="btn btn-outline-secondary btn-edit"
            data-row="${r.rowIndex || ''}"
            data-name="${r.name ?? ''}"
            data-code="${r.code ?? ''}"
            data-job="${r.job ?? ''}"
            data-level="${r.level ?? ''}"
            data-attack="${r.attack ?? ''}"
            data-camp="${r.camp ?? ''}">ä¿®æ”¹</button>
        </td>
      </tr>`).join('');
  }

  $('#tableBody').html(html);

  // ç¶å®šã€Œä¿®æ”¹ã€
  $('#tableBody').off('click', '.btn-edit').on('click', '.btn-edit', function(){
    const $btn = $(this);
    openEditor({
      name:  $btn.data('name'),
      code:  $btn.data('code'),
      job:   $btn.data('job'),
      level: $btn.data('level'),
      attack:$btn.data('attack'),
      camp:  $btn.data('camp'),
      rowIndex: Number($btn.data('row') || 0)
    }, (updated) => {
      // æ›´æ–°å‰ç«¯ç•¶åˆ—
      const tr = $btn.closest('tr')[0];
      const tds = tr.querySelectorAll('td');
      tds[0].textContent = updated.name;
      tds[1].textContent = updated.code;
      tds[2].textContent = updated.job;
      tds[3].textContent = updated.level;
      tds[4].textContent = updated.attack;
      tds[5].textContent = updated.camp;

      $btn.data('name',  updated.name);
      $btn.data('code',  updated.code);
      $btn.data('job',   updated.job);
      $btn.data('level', updated.level);
      $btn.data('attack',updated.attack);
      $btn.data('camp',  updated.camp);
    });
  });
}

/* =========================
   åˆ†é åˆ‡æ›ï¼ˆâ˜… æ–°å¢ï¼‰
========================= */
function setTab(tab) {
  currentTab = tab; // 'latus' | 'zakum' | 'trainext'
  // åˆ‡æ›æ¨£å¼
  $('#tabLatus').toggleClass('active', tab === 'latus');
  $('#tabLatusHard').toggleClass('active', tab === 'latushard');
  $('#tabZakumList').toggleClass('active', tab === 'zakum');
  $('#tabTrainExt').toggleClass('active', tab === 'trainext');
  // ä¾ç›®å‰åˆ†é é‡ç¹ª
  renderTable(lastData);
}

	$('#tabLatus').on('click',     () => setTab('latus'));
	$('#tabLatusHard').on('click', () => setTab('latushard'));
	$('#tabZakumList').on('click', () => setTab('zakum'));
	$('#tabTrainExt').on('click',  () => setTab('trainext'));


function loadFromSheet_OneP(sheetId, gid = '0') {
  $('#msg').text('');
  $('#tableBody').html(`
    <tr>
      <td colspan="4" class="text-center text-muted">è®€å–ä¸­...</td>
    </tr>
  `);

  const csvUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=csv&gid=${gid}`;

  Papa.parse(csvUrl, {
    download: true,
    skipEmptyLines: true,
    complete: function (result) {
      try {
        if (!result.data || result.data.length < 2) {
          $('#msg').text('æ²’æœ‰è³‡æ–™å¯é¡¯ç¤º');
          lastData = [];
          renderTable_OneP(lastData);
          return;
        }

        const rows = result.data.slice(1);
        lastData = rows
          .map((r, i) => ({
            category:  	r[0], // A
            name:  		r[1], // Bï¼ˆä¸»éµï¼‰
            keyword:	r[2], // C
            link: 		r[3], // D
            rowIndex: 	i + 2
          }))
          .filter(r => r && r.name);

        renderTable_OneP(lastData);
      } catch (e) {
        console.error(e);
        $('#msg').text('è§£æè³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤');
        lastData = [];
        renderTable_OneP(lastData);
      }
    },
    error: function (err) {
      console.error(err);
      $('#msg').text('è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªè©² Google Sheet å·²è¨­ç‚ºã€ŒçŸ¥é“é€£çµçš„ä»»ä½•äººå¯æª¢è¦–ã€ã€‚');
      lastData = [];
      renderTable_OneP(lastData);
    }
  });
}



function renderTable_OneP(data) {
  // ä¾ç›®å‰åˆ†é éæ¿¾ç‡Ÿå€
  const zhNums = 'ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å';
  const reLatus = new RegExp(`^æ™®æ‹‰[${zhNums}]ç‡Ÿ$`);
  const reLatushard = new RegExp(`^å›°æ‹‰[${zhNums}]ç‡Ÿ$`);
  const reZakum = new RegExp(`^ç‚é­”[${zhNums}]ç‡Ÿ$`);

  const groupNotes = {
    'æ™®æ‹‰ä¸€ç‡Ÿ': 'BOOæ”»ç•¥',
    'æ™®æ‹‰äºŒç‡Ÿ': 'éŠæˆ²çŸ¥è­˜',
  };

  const filtered = data;
  //(data || []).filter(r => {
  //  const camp = (r.camp || '').trim();
  //  if (currentTab === 'latus')   return reLatus.test(camp);
  //  if (currentTab === 'latushard')  return reLatushard.test(camp);
  //  if (currentTab === 'zakum')   return reZakum.test(camp);
  //  if (currentTab === 'trainext')return (camp === 'è¨“ç·´ç‡Ÿ' || camp === 'å¤–æ´å¤§å¤§');
  //  return true;
  //});
  
  // ...ï¼ˆä½ åŸæœ¬ renderTable å¾ŒçºŒçš„åˆ†çµ„/æ’åº/è¼¸å‡ºä¿æŒä¸è®Šï¼‰


  if (!filtered.length) {
    $('#tableBody_OneP').html(`
      <tr>
        <td colspan="4" class="text-center text-muted">æ­¤åˆ†é ä¸‹æ²’æœ‰ç¬¦åˆçš„è³‡æ–™</td>
      </tr>
    `);
    return;
  }
  
  // ä¾ç‡Ÿå€åˆ†çµ„
  const groups = {};
  for (const r of filtered) {
    const key = (r.category || 'æœªå¡«å¯«').toString().trim();
    if (!groups[key]) groups[key] = [];
    groups[key].push(r);
  }

  //// ä¾ã€Œä¸€äºŒä¸‰â€¦åã€æ’åº
  //const mapCN = { 'é›¶':0,'ã€‡':0,'ä¸€':1,'äºŒ':2,'å…©':2,'ä¸‰':3,'å››':4,'äº”':5,'å…­':6,'ä¸ƒ':7,'å…«':8,'ä¹':9,'å':10 };
  //function chineseNumToInt(txt) {
  //  if (!txt) return NaN;
  //  const m = txt.match(/[é›¶ã€‡ä¸€äºŒå…©ä¸‰å››äº”å…­ä¸ƒå…«ä¹å]/g);
  //  if (!m) return NaN;
  //  const s = m.join('');
  //  if (s === 'å') return 10;
  //  const tenIdx = s.indexOf('å');
  //  if (tenIdx === -1) return mapCN[s] ?? NaN;
  //  const left = tenIdx === 0 ? 1 : (mapCN[s[0]] ?? 0);
  //  const right = tenIdx === s.length - 1 ? 0 : (mapCN[s[tenIdx+1]] ?? 0);
  //  return left * 10 + right;
  //}

  //const orderedKeys = Object.keys(groups).sort((a,b) => 
  //{
  //  //const na = chineseNumToInt(a);
  //  //const nb = chineseNumToInt(b);
  //  if (!isNaN(na) && !isNaN(nb)) return na - nb;
  //  return a.localeCompare(b, 'zh-Hant');
  //});
  const orderedKeys = Object.keys(groups);

  let html = '';
  for (const k of orderedKeys) {
    const note = groupNotes[k] ? `ã€€${groupNotes[k]}` : ''; // æœ‰å°ç…§å°±åŠ ï¼Œæ²’æœ‰å°±ç©ºå­—ä¸²
    html += `
      <tr class="group-row">
        <td colspan="4">ä¸€åœ–æµåˆ†é¡ï¼š${k}${note}ï¼ˆ${groups[k].length}ï¼‰</td>
      </tr>`;
    html += groups[k].map(r => `
      <tr>
        <td>${r.category ?? ''}</td>
        <td>${r.name ?? ''}</td>
        <td>${r.keyword ?? ''}</td>
		<td>
		${r.link ? `
		<a href="https://drive.google.com/file/d/${r.link}/" target="_blank">
		  <img src="https://lh3.googleusercontent.com/d/${r.link}=h200?authuser=0" alt=r.name title=r.name height="200px;">
		</a>
	    ` : 'ç„¡åœ–ç‰‡'}
		</td>
      </tr>`).join('');
  }
  
  $('#tableBody_OneP').html(html);

}



/* =========================
   å•Ÿå‹•æµç¨‹ï¼šè‡ªå‹•è®€å–
========================= */
const DEFAULT_SHEET_URL = 'https://docs.google.com/spreadsheets/d/1-j04395CPwDlZnJ2vUt3k4wsT5rPHgQWmujSQCi76Fs/edit?gid=0#gid=0';
const OnePicture_URL = 'https://docs.google.com/spreadsheets/d/1ZFHkpsHKc0LWQDNPrP8Y5NS27aee0mOniK2uB8C2zD4/edit?gid=0#gid=0';
function resolveSheetTarget(resolveURL) {
  const qp = getQueryParams();
  if (qp.sheetUrl) {
    const parsed = parseSheetFromUrl(qp.sheetUrl);
    if (parsed) return parsed;
  }
  if (qp.sheetId) {
    return { sheetId: qp.sheetId, gid: qp.gid || '0' };
  }
  const parsedDefault = parseSheetFromUrl(resolveURL);
  return parsedDefault || { sheetId: '', gid: '0' };
}
function updateSourceBadge(sheetId, gid) {
  if (!sheetId) return;
  const badge = $('#sourceBadge');
  badge.text(`sheetId=${sheetId} | gid=${gid}`);
  badge.removeClass('d-none');
}

$(function () 
{
  const target = resolveSheetTarget(DEFAULT_SHEET_URL);
  if (!target.sheetId) {
    $('#msg').text('ç„¡æ³•è§£ææŒ‡å®šçš„ Google Sheet é€£çµæˆ– sheetId');
    return;
  }
  updateSourceBadge(target.sheetId, target.gid);
  loadFromSheet(target.sheetId, target.gid);

  $('#reloadBtn').on('click', function () {
    loadFromSheet(target.sheetId, target.gid);
  });

  $('#addBtn').on('click', function () {
    openEditor({
      name: '', code: '', job: '', level: '', attack: '', camp: '',
      rowIndex: 0, __isNew: true
    }, () => { alert('å·²æ–°å¢'); });
  });
  
  
  const target_OneP = resolveSheetTarget(OnePicture_URL);
  if (!target_OneP.sheetId) {
    $('#msg').text('ç„¡æ³•è§£ææŒ‡å®šçš„ Google Sheet é€£çµæˆ– sheetId');
    return;
  }
  updateSourceBadge(target_OneP.sheetId, target_OneP.gid);
  loadFromSheet_OneP(target_OneP.sheetId, target_OneP.gid);

  $('#reloadBtn_OneP').on('click', function () {
    loadFromSheet_OneP(target_OneP.sheetId, target_OneP.gid);
  });

  
}
);

/* =========================
   ç·¨è¼¯è¦–çª—ï¼ˆå«ç‡Ÿå€ä¸‹æ‹‰ï¼‰â€” ä¿ç•™ä½ åŸæœ¬çš„å¯«å› GAS åšæ³•
========================= */
function createEditor() {
  const overlay = document.createElement('div');
  overlay.id = 'editOverlay';
  Object.assign(overlay.style, {
    position: 'fixed', inset: 0, background: 'rgba(0,0,0,.4)',
    display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 9999
  });

  const card = document.createElement('div');
  Object.assign(card.style, {
    background: '#fff', borderRadius: '12px', padding: '18px', width: 'min(520px, 92vw)',
    boxShadow: '0 10px 30px rgba(0,0,0,.2)', color: '#222', fontFamily: 'system-ui,-apple-system,BlinkMacSystemFont'
  });
  card.innerHTML = `
    <h3 style="margin:0 0 12px;font-size:18px;">ä¿®æ”¹è³‡æ–™</h3>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>è§’è‰²åç¨±ï¼ˆBï¼‰</span>
        <input id="edit_name" type="text" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
      </label>
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>è§’è‰²ä»£ç¢¼ï¼ˆCï¼‰</span>
        <input id="edit_code" type="text" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
      </label>
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>è§’è‰²è·æ¥­ï¼ˆDï¼‰</span>
        <input id="edit_job" type="text" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
      </label>
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>è§’è‰²ç­‰ç´šï¼ˆEï¼‰</span>
        <input id="edit_level" type="text" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
      </label>
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>è§’è‰²ä¹¾è¡¨ï¼ˆFï¼‰</span>
        <input id="edit_attack" type="text" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
      </label>
      <label style="display:flex;flex-direction:column;gap:6px;">
        <span>æ‰€åœ¨ç‡Ÿå€ï¼ˆGï¼‰</span>
        <select id="edit_camp" style="padding:8px 10px;border:1px solid #ddd;border-radius:8px;">
          <option value="">ï¼ˆè«‹é¸æ“‡ï¼‰</option>
          <!-- ä¾ä½ å¯¦éš›ä½¿ç”¨çš„ç‡Ÿå€å­—æ¨£ç¶­æŒå³å¯ -->
          <option>æ™®æ‹‰ä¸€ç‡Ÿ</option><option>æ™®æ‹‰äºŒç‡Ÿ</option><option>æ™®æ‹‰ä¸‰ç‡Ÿ</option><option>æ™®æ‹‰å››ç‡Ÿ</option><option>æ™®æ‹‰äº”ç‡Ÿ</option>
          <option>æ™®æ‹‰å…­ç‡Ÿ</option><option>æ™®æ‹‰ä¸ƒç‡Ÿ</option><option>æ™®æ‹‰å…«ç‡Ÿ</option><option>æ™®æ‹‰ä¹ç‡Ÿ</option><option>æ™®æ‹‰åç‡Ÿ</option>
		  <option>å›°æ‹‰ä¸€ç‡Ÿ</option><option>å›°æ‹‰äºŒç‡Ÿ</option><option>å›°æ‹‰ä¸‰ç‡Ÿ</option><option>å›°æ‹‰å››ç‡Ÿ</option><option>å›°æ‹‰äº”ç‡Ÿ</option>
          <option>å›°æ‹‰å…­ç‡Ÿ</option><option>å›°æ‹‰ä¸ƒç‡Ÿ</option><option>å›°æ‹‰å…«ç‡Ÿ</option><option>å›°æ‹‰ä¹ç‡Ÿ</option><option>å›°æ‹‰åç‡Ÿ</option>
          <option>ç‚é­”ä¸€ç‡Ÿ</option><option>ç‚é­”äºŒç‡Ÿ</option><option>ç‚é­”ä¸‰ç‡Ÿ</option><option>ç‚é­”å››ç‡Ÿ</option><option>ç‚é­”äº”ç‡Ÿ</option>
          <option>ç‚é­”å…­ç‡Ÿ</option><option>ç‚é­”ä¸ƒç‡Ÿ</option><option>ç‚é­”å…«ç‡Ÿ</option><option>ç‚é­”ä¹ç‡Ÿ</option><option>ç‚é­”åç‡Ÿ</option>
          <option>è¨“ç·´ç‡Ÿ</option><option>å¤–æ´å¤§å¤§</option>
        </select>
      </label>
    </div>
    <div class="d-flex gap-2 justify-content-end mt-3">
      <button id="btn_cancel" class="btn btn-light border">å–æ¶ˆ</button>
      <button id="btn_save" class="btn btn-primary">å„²å­˜</button>
    </div>
  `;
  overlay.appendChild(card);
  document.body.appendChild(overlay);
  return overlay;
}

function openEditor(values, onSave) {
  let overlay = document.getElementById('editOverlay');
  if (!overlay) overlay = createEditor();

  overlay.querySelector('#edit_name').value   = values.name  ?? '';
  overlay.querySelector('#edit_code').value   = values.code  ?? '';
  overlay.querySelector('#edit_job').value    = values.job   ?? '';
  overlay.querySelector('#edit_level').value  = values.level ?? '';
  overlay.querySelector('#edit_attack').value = values.attack?? '';

  const campSelect = overlay.querySelector('#edit_camp');
  const campValue  = values.camp ?? '';
  if (campValue) {
    const exists = Array.from(campSelect.options).some(o => o.value === campValue || o.text === campValue);
    if (!exists) campSelect.add(new Option(campValue, campValue));
    campSelect.value = campValue;
  } else {
    campSelect.value = '';
  }

  const btnCancel = overlay.querySelector('#btn_cancel');
  const btnSave   = overlay.querySelector('#btn_save');
  const close = () => overlay.remove();
  btnCancel.onclick = close;

  btnSave.onclick = async () => {
    const updated = {
      name:   overlay.querySelector('#edit_name').value.trim(),
      code:   overlay.querySelector('#edit_code').value.trim(),
      job:    overlay.querySelector('#edit_job').value.trim(),
      level:  overlay.querySelector('#edit_level').value.trim(),
      attack: overlay.querySelector('#edit_attack').value.trim(),
      camp:   overlay.querySelector('#edit_camp').value.trim(),
    };
    const isNew = !!values.__isNew;

    if (!GAS_UPDATE_URL || GAS_UPDATE_URL.includes('/dev')) {
      alert('è«‹è¨­å®šæ­£ç¢ºçš„ GAS_UPDATE_URLï¼ˆå¿…é ˆæ˜¯ /execï¼‰');
      return;
    }
    if (!updated.code) {
      alert('è§’è‰²ä»£ç¢¼ä¸å¯ç‚ºç©ºï¼ˆç”¨ä¾†å®šä½è¦æ›´æ–°çš„åˆ—ï¼‰');
      return;
    }

    try {
      const form = new URLSearchParams();
      form.set('action', 'upsertByCode');
      form.set('code',   updated.code);
      form.set('name',   updated.name);
      form.set('job',    updated.job);
      form.set('level',  updated.level);
      form.set('attack', updated.attack);
      form.set('camp',   updated.camp);

      const resp = await fetch(GAS_UPDATE_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
        body: form.toString(),
        cache: 'no-store',
        redirect: 'follow'
      });

      const text = await resp.text();
      let result;
      try { result = JSON.parse(text); } catch {
        throw new Error('GAS å›å‚³é JSONï¼Œè«‹ç¢ºèª Web App ç”¨ /exec ä¸”ã€Œä»»ä½•äººã€å¯å­˜å–ã€‚');
      }
      if (!resp.ok || result.status !== 'ok') {
        throw new Error(result.message || 'æ›´æ–°/æ–°å¢å¤±æ•—');
      }

      if (isNew) {
        const t = resolveSheetTarget(resolveSheetTarget);
        loadFromSheet(t.sheetId, t.gid);
      } else {
        onSave?.(updated);
      }
      alert(isNew ? 'æ–°å¢æˆåŠŸï¼' : 'æ›´æ–°æˆåŠŸï¼');
      close();
    } catch (e) {
      console.error(e);
      alert('é€å‡ºå¤±æ•—ï¼š' + e.message);
    }
  };
}
/* =========================
   å…¬æœƒè·æ¥­åˆ†ä½ˆçµ±è¨ˆï¼ˆChart.jsï¼‰
========================= */

// è·æ¥­åç¨±æ­£è¦åŒ–ï¼ˆåŒç¾©åˆä½µï¼‰
function normalizeJob(raw) {
  if (!raw) return 'ï¼ˆæœªå¡«å¯«ï¼‰';
  let s = String(raw).trim();

  // çµ±ä¸€æ¨™é»
  s = s.replace(/ï¼Œ/g, 'ã€');

  // å°ç…§è¡¨ï¼ˆå·¦é‚Šæ˜¯æ¢ä»¶ï¼Œå³é‚Šæ˜¯æœ€çµ‚æ­¸æˆ¶åç¨±ï¼‰
  const map = [
    { test: /^(åå­—è»|è‹±é›„)$/ , to: 'è‹±é›„' },
    { test: /^(é¨å£«|è–é¨å£«)$/ , to: 'è–é¨å£«' },
    { test: /^(é¾é¨å£«|é»‘é¨å£«)$/ , to: 'é»‘é¨å£«' },

    { test: /^(ç«é­”å°å£«|å¤§é­”å°å£«\(ç«ã€æ¯’\))$/ , to: 'å¤§é­”å°å£«(ç«ã€æ¯’)' },
    { test: /^(å†°é­”å°å£«|å¤§é­”å°å£«\(å†°ã€é›·\))$/ , to: 'å¤§é­”å°å£«(å†°ã€é›·)' },

    { test: /^(ç¥­å¸|ä¸»æ•™)$/ , to: 'ä¸»æ•™' },
    { test: /^(éŠä¿ |ç®­ç¥)$/ , to: 'ç®­ç¥' },
    { test: /^(ç‹™æ“Šæ‰‹|ç¥å°„æ‰‹)$/ , to: 'ç¥å°„æ‰‹' },

    { test: /^(æš—æ®ºè€…|å¤œä½¿è€…)$/ , to: 'å¤œä½¿è€…' },
    { test: /^(ç¥å·|æš—å½±ç¥å·)$/ , to: 'æš—å½±ç¥å·' },

    { test: /^(æ ¼é¬¥å®¶|æ‹³éœ¸)$/ , to: 'æ‹³éœ¸' },
    { test: /^(ç¥æ§æ‰‹|æ§ç¥)$/ , to: 'æ§ç¥' },

    { test: /^åˆæ–°è€…$/, to: 'åˆæ–°è€…' } // ä¾ä½ æä¾›çš„å­—æ¨£
  ];

  for (const rule of map) {
    if (rule.test.test(s)) return rule.to;
  }
  return s; // å…¶ä»–è·æ¥­ç¶­æŒåŸå
}
/* ===== é¡è‰²å°ç…§ï¼ˆä¾ä½ æŒ‡å®šçš„è‰²ç³»ï¼‰ ===== */
const JOB_COLOR = {
  'è‹±é›„':            '#FFD24D', // é»ƒè‰²
  'è–é¨å£«':          '#F5F5F0', // å¥¶ç™½è‰²
  'é»‘é¨å£«':          '#1F1F1F', // é»‘è‰²

  'å¤§é­”å°å£«(ç«ã€æ¯’)': '#FF9999', // æ·ºç´…è‰²
  'å¤§é­”å°å£«(å†°ã€é›·)': '#99CCFF', // æ·ºè—è‰²
  'ä¸»æ•™':            '#FFF3B0', // æ·¡é»ƒè‰²
  'ç®­ç¥':            '#4CAF50', // ç¶ è‰²
  'ç¥å°„æ‰‹':          '#26A69A', // è—ç¶ è‰²

  'å¤œä½¿è€…':          '#5E35B1', // æ·±ç´«è‰²
  'æš—å½±ç¥å·':        '#4A4A4A', // é»‘ç°è‰²
  'æ‹³éœ¸':            '#D4AF37', // é‡‘è‰²
  'æ§ç¥':            '#E0E0E0', // ç™½ç°è‰²
  'åˆæ–°è€…':          '#FFFFFF'  // ç™½è‰²
};

// å–å¾—é¡è‰²ï¼ˆæœªçŸ¥è·æ¥­çµ¦ä¸­æ€§ç°ï¼‰
function getJobColor(name) {
  return JOB_COLOR[name] || '#9E9E9E';
}

// ç™½/å¥¶ç™½ç­‰å¾ˆæ·ºçš„é¡è‰²åŠ æ·±é‚Šæ¡†ï¼Œå…¶ä»–çµ±ä¸€æ·±é‚Šæ¡†ï¼Œè®“åˆ‡ç‰‡æœ‰ç•Œç·š
function getJobBorderColor(name) {
  const c = (JOB_COLOR[name] || '').toLowerCase();
  if (c === '#ffffff' || c === '#f5f5f0' || c === '#fff3b0' || c === '#ff9999' || c === '#99ccff') {
    return '#333333';
  }
  return '#222222';
}

// ç”Ÿæˆçµ±è¨ˆè³‡æ–™ï¼ˆä¸å«å¤–æ´å¤§å¤§ï¼‰
function buildJobStatsData() {
  const source = Array.isArray(lastData) ? lastData : [];
  const rows = source.filter(r => (r?.camp || '').trim() !== 'å¤–æ´å¤§å¤§');

  const counter = Object.create(null);
  for (const r of rows) {
    const key = normalizeJob(r?.job);
    counter[key] = (counter[key] || 0) + 1;
  }

  // è½‰é™£åˆ—ä¸”ä¾æ•¸é‡æ’åºï¼ˆç”±å¤šåˆ°å°‘ï¼‰
  const entries = Object.entries(counter).sort((a,b) => b[1] - a[1]);
  return {
    labels: entries.map(e => e[0]),
    values: entries.map(e => e[1]),
    total: rows.length
  };
}

let _jobChartInstance = null;

function renderJobChart() {
  const ctx = document.getElementById('jobStatsCanvas');
  if (!ctx) return;

  const data = buildJobStatsData();

  const bgColors = data.labels.map((name) => getJobColor(name));
  const borderColors = data.labels.map((name) => getJobBorderColor(name));

  const chartData = {
    labels: data.labels,
    datasets: [{
      label: 'äººæ•¸',
      data: data.values,
      backgroundColor: bgColors,
      borderColor: borderColors,
      borderWidth: 1.5,
      hoverOffset: 6
    }]
  };

  const options = {
    responsive: true,
    plugins: {
      legend: { display: true, position: 'bottom' },
      tooltip: {
        callbacks: {
          label: (ctx) => {
            const value = ctx.parsed;
            const total = data.total || 1;
            const pct = (value * 100 / total).toFixed(1);
            return `${ctx.label}: ${value} äººï¼ˆ${pct}%ï¼‰`;
          }
        }
      },
      title: {
        display: true,
        text: `å…¬æœƒè·æ¥­åˆ†ä½ˆï¼ˆç¸½æ•¸ï¼š${data.total}ï¼‰`
      }
    }
  };

  if (_jobChartInstance) {
    _jobChartInstance.data = chartData;
    _jobChartInstance.options = options;
    _jobChartInstance.update();
  } else {
    _jobChartInstance = new Chart(ctx, { type: 'doughnut', data: chartData, options });
  }
}

// ç¶å®šæŒ‰éˆ•ï¼šé»æ“Šæ™‚é–‹å•Ÿ Modal ä¸¦æ¸²æŸ“
$(document).on('click', '#btnJobStats', function(){
  // è‹¥æ¸…å–®å°šæœªè¼‰å…¥ï¼Œæç¤ºä¸€ä¸‹
  if (!Array.isArray(lastData) || lastData.length === 0) {
    alert('å°šæœªè®€å–åˆ°è³‡æ–™ï¼Œè«‹å…ˆç­‰å¾…åˆ—è¡¨è¼‰å…¥æˆ–é»æ“Šé‡æ–°æ•´ç†å¾Œå†è©¦ã€‚');
    return;
  }
  // å…ˆæ‰“é–‹ Modalï¼Œå†æ¸²æŸ“ï¼ˆå¯ç¢ºä¿ canvas å°ºå¯¸æ­£ç¢ºï¼‰
  const modal = new bootstrap.Modal(document.getElementById('jobStatsModal'));
  modal.show();
  // ç­‰ Modal å‹•ç•«è·‘èµ·ä¾†å†æ¸²æŸ“ï¼Œé¿å…åˆå§‹å¯¬åº¦ 0
  setTimeout(renderJobChart, 150);
});

// è‹¥ä½ å¸Œæœ›æ¯æ¬¡é—œé–‰éƒ½éŠ·æ¯€åœ–è¡¨ï¼ˆé¿å…è¨˜æ†¶é«”ç´¯ç©ï¼‰ï¼Œå¯å•Ÿç”¨ä»¥ä¸‹ï¼š
// $('#jobStatsModal').on('hidden.bs.modal', function() {
//   if (_jobChartInstance) {
//     _jobChartInstance.destroy();
//     _jobChartInstance = null;
//   }
// });

/* ==== æ‹‰åœ–æ–¯æ”»ç•¥ï¼šå¸¸æ•¸ ==== */
// å›°é›£æ‹‰åœ–æ–¯ï¼ˆGoogle Doc é é¢ï¼‰
const LATUS_HARD_DOC_EMBED = "https://docs.google.com/document/d/1UrV2RrEJwLZJ8X5t88GXRuxKbbxp9vq6W2Qeu1nqzV0/preview";

// æ™®é€šæ‹‰åœ–æ–¯ï¼šé¡¯ç¤ºã€Œæ–½å·¥ä¸­ã€
const LATUS_WIP_HTML = `
<!doctype html><html lang="zh-TW"><meta charset="utf-8">
<title>æ–½å·¥ä¸­</title>
<style>
  html,body{height:100%;margin:0}
  body{display:flex;align-items:center;justify-content:center;font-family:system-ui,-apple-system,BlinkMacSystemFont;
       background:#f8f9fa}
  .box{text-align:center}
  h1{font-size:28px;margin:0 0 8px}
  p{margin:0;color:#6c757d}
</style>
<div class="box">
  <h1>ğŸ› ï¸ æ–½å·¥ä¸­</h1>
  <p>æ™®é€šæ‹‰åœ–æ–¯æ”»ç•¥å…§å®¹å»ºç½®ä¸­ï¼Œæ•¬è«‹æœŸå¾…ï¼</p>
</div>`;
const LATUS_WIP_DATAURL = "data:text/html;charset=UTF-8," + encodeURIComponent(LATUS_WIP_HTML);

/* ==== å°è¦½åˆ—ï¼šæ‹‰åœ–æ–¯æ”»ç•¥ æŒ‰éˆ•åˆ‡é  ==== */
$('#LatusGuide').on('click', function () {
  $('#homePage').addClass('d-none');
  $('#zakumPage').addClass('d-none');
  $('#latusPage').removeClass('d-none');

  // é è¨­é¡¯ç¤ºã€Œæ–½å·¥ä¸­ã€
  const $f = $('#latusDocFrame');
  if ($f.attr('src') !== LATUS_WIP_DATAURL) $f.attr('src', LATUS_WIP_DATAURL);
});

/* ==== æ‹‰åœ–æ–¯æ”»ç•¥ï¼šå­æŒ‰éˆ•è¡Œç‚º ==== */
//$('#btnLatusNormal').on('click', function(){
//  const $f = $('#latusDocFrame');
//  if ($f.attr('src') !== LATUS_WIP_DATAURL) $f.attr('src', LATUS_WIP_DATAURL);
//});
//
//$('#btnLatusHard').on('click', function(){
//  const $f = $('#latusDocFrame');
//  if ($f.attr('src') !== LATUS_HARD_DOC_EMBED) $f.attr('src', LATUS_HARD_DOC_EMBED);
//});


// å”å”ç‰ˆä¸€åœ–æµæ”»ç•¥ï¼ˆGoogle Sheets åµŒå…¥ï¼‰
const UNCLE_GUIDE_SHEET_ID = '1a3nRjzvfelHg1zeKyJpUfddRO9A1v68SnS4VnPp2K1s';
const UNCLE_GUIDE_EMBED = `https://docs.google.com/spreadsheets/d/${UNCLE_GUIDE_SHEET_ID}/preview`;
const UNCLE_GUIDE_LINK  = `https://docs.google.com/spreadsheets/d/${UNCLE_GUIDE_SHEET_ID}/edit?usp=sharing`;

$(document).on('click', '#btnUncleGuide', function () 
{
  // è¨­å®š iframe èˆ‡ã€Œåœ¨æ–°é é¢é–‹å•Ÿã€è¶…é€£çµ
  const $frame = $('#uncleGuideFrame');
  if ($frame.attr('src') !== UNCLE_GUIDE_EMBED) {
    $frame.attr('src', UNCLE_GUIDE_EMBED);
  }
  $('#uncleGuideOpenNew').attr('href', UNCLE_GUIDE_LINK);

  // é¡¯ç¤º Modal
  const modal = new bootstrap.Modal(document.getElementById('uncleGuideModal'));
  modal.show();
});


</script>
</body>
</html>
